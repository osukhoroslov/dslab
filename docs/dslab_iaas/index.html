<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="DSLab IaaS"><title>dslab_iaas - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-cb6f1f67f1bcd037.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="dslab_iaas" data-themes="" data-resource-suffix="" data-rustdoc-version="1.73.0 (cc66ad468 2023-10-03)" data-channel="1.73.0" data-search-js="search-6dfdfced5eff6596.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-1596385f77d47ef2.css" data-theme-dark-css="dark-0a43001d3fc2282c.css" data-theme-ayu-css="ayu-fd19013d6ce078bf.css" ><script src="../static.files/storage-db41da1a38ea3cb8.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-1596385f77d47ef2.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-0a43001d3fc2282c.css"><link rel="stylesheet" href="../static.files/noscript-cffde32267a19fd6.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../dslab_iaas/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../dslab_iaas/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate dslab_iaas</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.1.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">dslab_iaas</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/dslab_iaas/lib.rs.html#1-7">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="dslab-iaas"><a href="#dslab-iaas">DSLab IaaS</a></h2><h3 id="overview"><a href="#overview">Overview</a></h3>
<p>A library for simulation of Infrastructure as a Service (IaaS) clouds aimed to facilitate research in cloud resource management.</p>
<p>It can be used by cloud computing academic studies to implement user specific simulations. The simulator contains a set of standard components which allow developers to focus on specific system design issues to be investigated, without concerning the low-level details of simulation. At the same time, any component can be easily extended or replaced by the user to meet their behavior requirements. As the result, the library supports simple, easy-to-understand simulations and also grants the access to low-level details.</p>
<p>The library enables modelling of different cloud infrastructure components such as physical machines (via <a href="https://github.com/osukhoroslov/dslab/blob/main/crates/dslab-iaas/src/core/host_manager.rs">HostManager</a>), virtual machines (via <a href="https://github.com/osukhoroslov/dslab/blob/main/crates/dslab-iaas/src/core/vm.rs">VirtualMachine</a>) and core services (VM scheduler, placement store, monitoring, etc). The simulation is implemented as a chain of discrete events by means of <a href="https://github.com/osukhoroslov/dslab/tree/main/crates/dslab-core">DSLab simulation core</a>. The components produce events during the simulation and process events produced by other components via event handlers.</p>
<p>The simulation is configured and managed via <a href="https://github.com/osukhoroslov/dslab/blob/main/crates/dslab-iaas/src/simulation.rs">CloudSimulation</a>. It encapsulates all simulations components and provides convenient access to them for the user. It provides an interface to add new physical machines, submit virtual machines and migrate them, add new user defined components etc. As long as the simulation has some unprocessed events, it is possible to run simulation for a few steps or time period by processing events in the order of their timestamps.</p>
<p>Basic examples of library usage can be found <a href="https://github.com/osukhoroslov/dslab/blob/main/examples/iaas/src/main.rs">here</a>.</p>
<h3 id="virtual-machines-allocation"><a href="#virtual-machines-allocation">Virtual machines allocation</a></h3>
<p>Virtual machines can be submitted to cloud resource pool via <a href="https://github.com/osukhoroslov/dslab/blob/main/crates/dslab-iaas/src/core/scheduler.rs">Scheduler</a> component. The scheduler processes VM allocation events and selects the physical machine (aka host) for running VM. It stores a local copy of resource pool state, which includes information of current resource allocations on each host. Scheduler can also access information about current hosts’ load from the monitoring component. The actual VM placement decision is delegated to the user-defined <a href="https://github.com/osukhoroslov/dslab/blob/main/crates/dslab-iaas/src/core/vm_placement_algorithm.rs">VM placement algorithm</a>.</p>
<p>The library supports simulating a cloud with multiple schedulers that concurrently process allocation requests. Since each scheduler operates using its own, possibly outdated resource pool state, the schedulers’ decisions may produce conflicts. These conflicts are resolved by a centralized database called <a href="https://github.com/osukhoroslov/dslab/blob/main/crates/dslab-iaas/src/core/placement_store.rs">PlacementStore</a> (PS). Each scheduler sends its placement decisions to the PS. If no conflicts are detected, the allocation is committed and an allocation request is sent to the selected host.</p>
<p>Virtual machine can be submitted to cluster by calling <code>spawn_vm_now</code> or <code>spawn_vm_with_delay</code> function:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>sim = Simulation::new(<span class="number">123</span>); <span class="comment">// create dslab-core simulation
</span><span class="kw">let </span><span class="kw-2">mut </span>cloud_sim = CloudSimulation::new(sim, sim_config); <span class="comment">// create cloud simulation

</span><span class="kw">let </span>host = cloud_sim.add_host(<span class="string">&quot;h&quot;</span>, <span class="number">30</span>, <span class="number">30</span>); <span class="comment">// create host with 30 vCPU-s and 30 GB of RAM 
</span><span class="kw">let </span>s = cloud_sim.add_scheduler(<span class="string">&quot;s&quot;</span>, Box::new(BestFit::new())); <span class="comment">// create scheduler which uses Best Fit packing algorithm

// spawn new VM
</span>cloud_sim.spawn_vm_now(
    <span class="number">10</span>, <span class="comment">// requires 10 vCPU-s
    </span><span class="number">10</span>, <span class="comment">// requires 10 GB of RAM
    </span><span class="number">2.0</span>, <span class="comment">// lifetime is 2 seconds
    </span>Box::new(ConstLoadModel::new(<span class="number">1.0</span>)), <span class="comment">// VM will use 100% of allocated CPU resources
    </span>Box::new(ConstLoadModel::new(<span class="number">1.0</span>)), <span class="comment">// VM will use 100% of allocated RAM resources
    </span><span class="prelude-val">None</span>, <span class="comment">// possible to pass here VM ID, but in this case simulation will generate it itself
    </span>s, <span class="comment">// submit to scheduler s
</span>);</code></pre></div>
<h3 id="resource-overcommitment"><a href="#resource-overcommitment">Resource overcommitment</a></h3>
<p>It is possible to configure the simulation whether to support resource overcommitment or not. <a href="https://github.com/osukhoroslov/dslab/blob/main/crates/dslab-iaas/src/core/config.rs#L27">allow_vm_overcommit</a> parameter in simulation config enables a possibility to submit additional VMs on a physical host even if all resources on that host are allocated. Schedulers can pack virtual machines until any resource load reaches 80% threshold.</p>
<p>Overcommitment in simulation can be modelled by spawning virtual machines with low resource usage. In the following scenario the VM actual usage is only 1 vCPU and 1 GB of memory which makes it possible to add more VMs on that host and utilize the remaining 9 vCPUs.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="comment">// spawn new VM
</span>cloud_sim.spawn_vm_now(
    <span class="number">10</span>, <span class="comment">// allocate 10 vCPU-s
    </span><span class="number">10</span>, <span class="comment">// allocate 10 GB of RAM
    </span><span class="number">2.0</span>, <span class="comment">// lifetime is 2 seconds
    </span>Box::new(ConstLoadModel::new(<span class="number">0.1</span>)), <span class="comment">// uses only 10% of allocated CPU
    </span>Box::new(ConstLoadModel::new(<span class="number">0.1</span>)), <span class="comment">// uses only 10% of allocated RAM
    </span><span class="prelude-val">None</span>, <span class="comment">// possible to pass here VM ID, but in this case simulation will generate it itself
    </span>s, <span class="comment">// submit to scheduler s
</span>);</code></pre></div>
<p>To access the actual host load, a monitoring component is provided to any VM placement algorithm. The standard library contains <a href="https://github.com/osukhoroslov/dslab/blob/main/crates/dslab-iaas/src/core/vm_placement_algorithm.rs#L87">BestFitThreshold</a> algorithm, which selects a host with maximal actual CPU load among all feasible candidates within a given threshold. It is possible to implement other algorithms and use them in simulations.</p>
<h3 id="registering-new-components"><a href="#registering-new-components">Registering new components</a></h3>
<p>New components can be added to <code>CloudSimulation</code> in order to implement any custom logic that cannot be performed by existing ones. An example of such component is <a href="https://github.com/osukhoroslov/dslab/blob/main/crates/dslab-iaas/src/extensions/vm_migrator.rs#L22">VmMigrator</a>. It periodically checks the state of resource pool and tries to find the overloaded and underloaded hosts. If there are any, it selects some VMs from these hosts and migrates them to other hosts in order to turn off the underloaded hosts and return the overloaded hosts to normal state.</p>
<p>To interact with standard components during simulation, user component should implement <code>EventHandler</code> interface and a method for passing references to needed components like <code>patch_custom_args()</code> in the example below.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span>migrator = cloud_sim.build_custom_component::&lt;VmMigrator&gt;(<span class="string">&quot;migrator&quot;</span>); <span class="comment">// create component
</span>migrator
    .borrow_mut()
    .patch_custom_args(<span class="number">5.</span>, cloud_sim.monitoring(), cloud_sim.vm_api(), cloud_sim.sim_config()); <span class="comment">// pass required standard components
</span>migrator.borrow_mut().init(); <span class="comment">// initialize component, start periodic process</span></code></pre></div>
<h3 id="public-traces-usage"><a href="#public-traces-usage">Public traces usage</a></h3>
<p>The library supports two different public cloud traces - Huawei Cloud 2021 and Microsoft Azure 2020. The examples can be found <a href="https://github.com/osukhoroslov/dslab/tree/main/examples/iaas-traces">here</a>. Supporting other traces requires the implementation of a dataset reader, which should support the <a href="https://github.com/osukhoroslov/dslab/blob/main/crates/dslab-iaas/src/extensions/dataset_reader.rs#L10">DatasetReader</a> trait. After the reader is ready, the dataset can be used in simulation as follows:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">let </span><span class="kw-2">mut </span>dataset = HuaweiDatasetReader::new(config.simulation_length); <span class="comment">// create dataset
</span>dataset.parse(<span class="macro">format!</span>(<span class="string">&quot;{}/Huawei-East-1.csv&quot;</span>, dataset_path));         <span class="comment">// parse dataset file

</span><span class="kw">let </span>scheduler_id = cloud_sim.add_scheduler(<span class="string">&quot;s&quot;</span>, Box::new(FirstFit::new())); <span class="comment">// create scheduler where to submit dataset VMs
</span>cloud_sim.spawn_vms_from_dataset(scheduler_id, dataset);</code></pre></div>
<p>The last call injects the VM allocation and release events from the trace into the simulation by passing them to a given scheduler. Note that all parameters like VM start time and lifetime duration should be set during the dataset parsing.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="core/index.html" title="mod dslab_iaas::core">core</a></div></li><li><div class="item-name"><a class="mod" href="custom_component/index.html" title="mod dslab_iaas::custom_component">custom_component</a></div><div class="desc docblock-short">Trait for implementation of custom components.</div></li><li><div class="item-name"><a class="mod" href="experiment/index.html" title="mod dslab_iaas::experiment">experiment</a></div><div class="desc docblock-short">Tools for running experiments with multiple simulation runs.</div></li><li><div class="item-name"><a class="mod" href="extensions/index.html" title="mod dslab_iaas::extensions">extensions</a></div></li><li><div class="item-name"><a class="mod" href="simulation/index.html" title="mod dslab_iaas::simulation">simulation</a></div><div class="desc docblock-short">The main entry point for simulation configuration and execution.</div></li></ul></section></div></main></body></html>